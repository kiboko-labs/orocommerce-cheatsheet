<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="Kiboko">
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Behat elements form - orocommerce-cheatsheet</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../../css/theme.css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Behat elements form";
    var mkdocs_page_input_path = "tests/behat-elements-form.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> orocommerce-cheatsheet</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Useful commands</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../command/oro1/">Oro 1.x</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../command/oro3/">Oro 3.x</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Backend tips</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../backend/remove-price-filter/">Remove Price filter and sorter</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">Comment créer un EventListener pour modifier une DataGrid</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../backend/event-listener-datagrid-orm-result/">Orm Result</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../backend/event-listener-datagrid-structure/">Structure</a>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../backend/dynamic-action-datagrid/">Gérer dynamiquement des actions dans une datagrid</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../backend/pass-param-to-datagrid/">Faire passer un paramètre à une datagrid</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../backend/delete-entity/">Comment supprimer proprement une entité</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../backend/handler-provider-update/">Faire des handlers / providers (update entity)</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../backend/oro-config-select-type/">Champ select en config</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Frontend tips</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../frontend/BlockTypes/">BlockTypes examples</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../frontend/ElementList/">List of Ui element present in OroUIBundle::macros.html.twig</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../frontend/findblockname/">Find Twig Template block names</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../frontend/mass-actions/">Ajouter une Mass-Action sur la grille des produits</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../frontend/form/">Create a frontend form for an entity</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../frontend/consent-rgpd/">RGPD</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../frontend/products-list/">Product List</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Environment tips</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../environment/installer-xdebug-php71/">Installer Xdebug pour php 7.1 sur MacOS</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../environment/installer-rabbitmq-brew/">Installer RabbitMQ avec Brew sur MacOS</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../environment/avoir-xdebug-a-la-demande/">Activer XDebug à la demande</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../environment/supervisor/">Utilisation de Supervisor</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../environment/composer-tips/">Utilisation de composer</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../postgresql/insert-medias/">Insert product medias in the database</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../postgresql/sql-tips/">Pour identifier les tables lourdes</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Migration tips</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../migrations/introduction/">Introduction schema manipulation</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../migrations/enum/">Managing enums</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../migrations/businessUnit/">Extending an entity (Business Unit example)</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../migrations/view/">Managing the fields order on the form view</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../migrations/configuration/">Configuring the platform via migrations</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../migrations/delete-completely-an-enum/">Delete completely an enum</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Docker tips</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../docker/dump-sql-docker/">Maninipuler des dumps.sql avec Docker</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../docker/use-cache/">Utiliser le cache Docker</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../docker/clean-vm/">Nettoyer sa VM</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Test tips</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../intro/">Intro</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../behat/">Behat</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../javascript/">Javascript</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../functional/">Functionnal</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">orocommerce-cheatsheet</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
    
    <li>Behat elements form</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/kiboko-labs/orocommerce-cheatsheet/edit/master/docs/tests/behat-elements-form.md"
          class="icon icon-github"> Edit on Github</a>
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <p>Elements est une couche de service dans les tests behat. Ils enveloppent la logique métier complexe. Prenez une minute pour lire la base des <a href="https://github.com/minkphp/Mink/blob/9ea1cebe3dc529ba3861d87c818f045362c40484/src/Element/NodeElement.php">NodeElement Mink</a></p>
<p>Il y a de nombreuses méthodes publiques; certains d'entre eux ne s'appliquent qu'à certains éléments. Chaque test Bundle peut contenir un nombre particulier d'éléments.
Tous les éléments doivent être décrits dans {BundleName} {BundleName}/Tests/Behat/behat.yml de la manière suivante:</p>
<pre><code class="yaml"> oro_behat_extension:
   elements:
     Login:
       selector: '#login-form'
       class: Oro\Bundle\TestFrameworkBundle\Behat\Element\Form
       options:
         mapping:
           Username: '_username'
           Password: '_password'
</code></pre>

<p>ou :</p>
<ol>
<li><code>Login</code> est un nom d'élément qui DOIT être unique. L'élément peut être créé dans un contexte par OroElementFactory par son nom:</li>
</ol>
<pre><code class="php">$this-&gt;elementFactory-&gt;createElement('Login');
</code></pre>

<ol>
<li>selector` définit comment le driver Web doit trouver l'élément sur la page. Par défaut, lorsque le type de sélecteur n'est pas spécifié, le sélecteur css est utilisé.
Le sélecteur XPath est également pris en charge et peut être fourni avec la configuration suivante:</li>
</ol>
<pre><code class="yaml"> selector:
     type: xpath
     locator: //span[id='mySpan']/ancestor::form/
</code></pre>

<ol>
<li>
<p>Le namespace de l'élément (doit être étendu à partir de Oro\Bundle\TestFrameworkBundle\Behat\Element\Element<code>).
Lorsqu'elle est omise, la classe</code>Oro\Bundle\TestFrameworkBundle\Behat\Element\Element` est utilisée par défaut.</p>
</li>
<li>
<p><code>options</code> est un tableau d'options supplémentaires stockées dans la propriété options de la classe Element.
Il est fortement recommandé de fournir une classe avec des options de mappage pour les éléments de formulaire, car cela augmente la vitesse de test et garantit un mappage de champ plus précis.</p>
</li>
</ol>
<h2 id="mappage-des-champs-de-formulaire">Mappage des champs de formulaire</h2>
<p>Par défaut, les tests utilisent le <a href="http://mink.behat.org/en/latest/guides/traversing-pages.html#named-selectors">sélecteur de champ nommé</a>  pour mapper les champs du formulaire.
Le sélecteur de nom de champ a recherché le champ par son identifiant, son nom, son label ou son placeholder.
Vous êtes libre d'utiliser n'importe quel sélecteur pour mapper des champs de formulaire ou encapsuler un élément dans l'élément behat particulier.</p>
<pre><code class="yaml"> oro_behat_extension:
   elements:
     Payment Method Config Type Field:
       class: Oro\Bundle\PaymentBundle\Tests\Behat\Element\PaymentMethodConfigType
     PaymentRuleForm:
       selector: &quot;form[id^='oro_payment_methods_configs_rule']&quot;
       class: Oro\Bundle\TestFrameworkBundle\Behat\Element\Form
       options:
         mapping:
           Method:
             type: 'xpath'
             locator: '//div[@id[starts-with(.,&quot;uniform-oro_payment_methods_configs_rule_method&quot;)]]'
             element: Payment Method Config Type Field
</code></pre>

<p>Vous devez maintenant implémenter la méthode <code>setValue</code> de l'élément:</p>
<pre><code class="php">&lt;?php
 namespace Oro\Bundle\PaymentBundle\Tests\Behat\Element;
 use Oro\Bundle\TestFrameworkBundle\Behat\Element\Element;
 class PaymentMethodConfigType extends Element
 {
     /**
      * {@inheritdoc}
      */
     public function setValue($value)
     {
         $values = is_array($value) ? $value : [$value];
         foreach ($values as $item) {
             $parentField = $this-&gt;getParent()-&gt;getParent()-&gt;getParent()-&gt;getParent();
             $field = $parentField-&gt;find('css', 'select');
             self::assertNotNull($field, 'Select payment method field not found');
             $field-&gt;setValue($item);
             $parentField-&gt;clickLink('Add');
             $this-&gt;getDriver()-&gt;waitForAjax();
         }
     }
 }
</code></pre>

<p>Vous pouvez maintenant l'utiliser dans une étape standard:</p>
<pre><code class="yaml"> Feature: Payment Rules CRUD
   Scenario: Creating Payment Rule
     Given I login as administrator
     And I go to System/ Payment Rules
     And I click &quot;Create Payment Rule&quot;
     When I fill &quot;Payment Rule Form&quot; with:
       | Method | PayPal |
</code></pre>

<h3 id="mappages-de-formulaires-integres">Mappages de formulaires intégrés :</h3>
<p>Parfois, un formulaire apparaît dans l'iframe. Behat peut passer à l'iframe par son identifiant.
Pour remplir correctement le formulaire dans l'iframe, spécifiez l'id iframe dans les options du formulaire:</p>
<pre><code class="yaml">   oro_behat_extension:
     elements:
       MagentoContactUsForm:
         selector: 'div#page'
         class: Oro\Bundle\TestFrameworkBundle\Behat\Element\Form
         options:
           embedded-id: embedded-form
           mapping:
             First name: 'oro_magento_contactus_contact_request[firstName]'
             Last name: 'oro_magento_contactus_contact_request[lastName]'
</code></pre>

<h2 id="element-de-page">ELement de page</h2>
<p>L'élément Page encapsule la page Web entière avec son URL et son chemin d'accès à la page. Chaque élément Page doit étendre <code>Oro\Bundle\TestFrameworkBundle\Behat\Element\Page</code>.</p>
<p>Exemple de Configuration de Page :</p>
<pre><code class="yaml"> oro_behat_extension:
   pages:
     UserProfileView:
       class: Oro\Bundle\UserBundle\Tests\Behat\Page\UserProfileView
       route: 'oro_user_profile_view'
</code></pre>

<p>Exemple de classe de page:</p>
<pre><code class="php"> namespace Oro\Bundle\UserBundle\Tests\Behat\Page;

 use Oro\Bundle\TestFrameworkBundle\Behat\Element\Page;

 class UserProfileView extends Page
 {
     /**
      * {@inheritdoc}
      */
     public function open(array $parameters = [])
     {
         $userMenu = $this-&gt;elementFactory-&gt;createElement('UserMenu');
         $userMenu-&gt;find('css', '[data-toggle=&quot;dropdown&quot;]')-&gt;click();

         $userMenu-&gt;clickLink('My User');
     }
 }
</code></pre>

<p>Vous pouvez maintenant utiliser plusieurs étapes significatives:</p>
<pre><code class="yaml"> And I open User Profile View page
 And I should be on User Profile View page
</code></pre>
              
            </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
