<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="Kiboko">
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Configuring the platform via migrations - orocommerce-cheatsheet</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../../css/theme.css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Configuring the platform via migrations";
    var mkdocs_page_input_path = "migrations/configuration.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> orocommerce-cheatsheet</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <p class="caption"><span class="caption-text">Useful commands</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../command/oro1/">Oro 1.x</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../command/oro3/">Oro 3.x</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Backend tips</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../backend/remove-price-filter/">Remove Price filter and sorter</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">Comment créer un EventListener pour modifier une DataGrid</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../backend/event-listener-datagrid-structure/">Orm Result</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../backend/event-listener-datagrid-structure/">Structure</a>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../backend/dynamic-action-datagrid/">Gérer dynamiquement des actions dans une datagrid</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../backend/pass-param-to-datagrid/">Faire passer un paramètre à une datagrid</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../backend/delete-entity/">Comment supprimer proprement une entité</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../backend/handler-provider-update/">Faire des handlers / providers (update entity)</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../backend/oro-config-select-type/">Champ select en config</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Frontend tips</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../frontend/BlockTypes/">BlockTypes examples</a>
                    </li>
                    <li class="toctree-l1"><a class="" href="../../backend/ElementList.md">List of Ui element present in OroUIBundle::macros.html.twig</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../frontend/findblockname/">Find Twig Template block names</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../frontend/mass-actions/">Ajouter une Mass-Action sur la grille des produits</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../frontend/form/">Create a frontend form for an entity</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../frontend/consent-rgpd/">RGPD</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Environment tips</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../environment/installer-xdebug-php71/">Installer Xdebug pour php 7.1 sur MacOS</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../environment/installer-rabbitmq-brew/">Installer RabbitMQ avec Brew sur MacOS</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../environment/avoir-xdebug-a-la-demande/">Activer XDebug à la demande</a>
                    </li>
                    <li class="toctree-l1"><a class="" href="../../environment/supervisor">Utilisation de Supervisor</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../environment/composer-tips/">Utilisation de composer</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../postgresql/insert-medias/">Insert product medias in the database</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../postgresql/sql-tips/">Pour identifier les tables lourdes</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Migration tips</span></p>
                <ul class="current">
                    <li class="toctree-l1"><a class="reference internal" href="../introduction/">Introduction schema manipulation</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../enum/">Managing enums</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../businessUnit/">Extending an entity (Business Unit example)</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../view/">Managing the fields order on the form view</a>
                    </li>
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Configuring the platform via migrations</a>
    <ul class="current">
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../delete-completely-an-enum/">Delete completely an enum</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Docker tips</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../docker/dump-sql-docker/">Maninipuler des dumps.sql avec Docker</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../docker/use-cache/">Utiliser le cache Docker</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../docker/clean-vm/">Nettoyer sa VM</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Test tips</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../tests/intro/">Intro</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../tests/behat/">Behat</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../tests/javascript/">Javascript</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../tests/functional/">Functionnal</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">orocommerce-cheatsheet</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Migration tips &raquo;</li>
        
      
    
    <li>Configuring the platform via migrations</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/kiboko-labs/orocommerce-cheatsheet/edit/master/docs/migrations/configuration.md"
          class="icon icon-github"> Edit on Github</a>
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="configuring-the-platform-via-migrations">Configuring the platform via migrations</h1>
<p>The <code>oro:migration:data:load</code> command may also be used to set up a default configuration for the platform.</p>
<p>This configuration can be changed programatically thanks to the <code>Oro\Bundle\ConfigBundle\Config\ConfigManager</code>. Here's an example of implementation:</p>
<pre><code class="php">// AppBundle/Migrations/Data/ORM/Configuration.php

&lt;?php


namespace Kiboko\Bundle\AppBundle\Migrations\Data\ORM;


use Doctrine\Common\DataFixtures\AbstractFixture;
use Doctrine\Common\Persistence\ObjectManager;
use Oro\Bundle\ConfigBundle\Config\ConfigManager;
use Oro\Bundle\MigrationBundle\Fixture\VersionedFixtureInterface;
use Symfony\Component\DependencyInjection\ContainerAwareInterface;
use Symfony\Component\DependencyInjection\ContainerInterface;

abstract class Configuration extends AbstractFixture implements ContainerAwareInterface, VersionedFixtureInterface
{
    /** @var ConfigManager */
    protected $configManager;

    abstract protected function configure();

    /**
     * Sets the container.
     * @param ContainerInterface|null $container
     */
    public function setContainer(ContainerInterface $container = null)
    {
        $this-&gt;configManager = $container-&gt;get('oro_config.global');
    }

    /** @var ObjectManager */
    public function load(ObjectManager $manager)
    {
        $this-&gt;configure();

        $this-&gt;configManager-&gt;flush();
    }
}

</code></pre>

<pre><code class="php">// AppBundle/Migrations/Data/ORM/GuestAccessConfiguration.php

&lt;?php


namespace Kiboko\Bundle\AppBundle\Migrations\Data\ORM;


class GuestAccessConfiguration extends Configuration
{
    const VERSION = '1.0';

    /**
     * @return string
     */
    public function getVersion()
    {
        return self::VERSION;
    }

    protected function configure()
    {
        // Allow website access to guest users
        $this-&gt;configManager-&gt;set('oro_frontend.guest_access_enabled', true);
        // Enable guest checkout
        $this-&gt;configManager-&gt;set('oro_checkout.guest_checkout', true);
        // Enable guest shopping list
        $this-&gt;configManager-&gt;set('oro_shopping_list.availability_for_guests', true);
        // Disable quick order form for guest users
        $this-&gt;configManager-&gt;set('oro_product.guest_quick_order_form', false);
        // Disable guest RFQ
        $this-&gt;configManager-&gt;set('oro_rfp.guest_rfp', false);
    }
}
</code></pre>

<p>The <code>set</code> method of <code>$this-&gt;configManager</code> allows to change the value of the specified setting. The setting code is passed as first argument, and the value to be set as second argument. The setting code is formatted according to the following pattern: <code>&lt;section&gt;.&lt;name&gt;</code>.</p>
<p>The table below lists a few settings that may be changed with the configuration manager service:</p>
<table>
<thead>
<tr>
<th>section</th>
<th>name</th>
<th>type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>oro_checkout</td>
<td>guest_checkout</td>
<td>boolean</td>
<td>Enable/disable guest checkout</td>
</tr>
<tr>
<td>oro_frontend</td>
<td>guest_access_enabled</td>
<td>boolean</td>
<td>Enable/disable guest access</td>
</tr>
<tr>
<td>oro_frontend</td>
<td>frontend_theme</td>
<td>string</td>
<td>Set the theme for the frontend</td>
</tr>
<tr>
<td>oro_shopping_list</td>
<td>availability_for_guests</td>
<td>boolean</td>
<td>Enable/disable guest shopping list</td>
</tr>
<tr>
<td>oro_product</td>
<td>guest_quick_order_form</td>
<td>boolean</td>
<td>Enable/disable quick order form for guests</td>
</tr>
<tr>
<td>oro_product</td>
<td>single_unit_mode</td>
<td>boolean</td>
<td>Enable/disable Product Single Unit Mode</td>
</tr>
<tr>
<td>oro_product</td>
<td>single_unit_mode_show_code</td>
<td>boolean</td>
<td>Show/hide the product unit code</td>
</tr>
<tr>
<td>oro_rfp</td>
<td>guest_rfp</td>
<td>boolean</td>
<td>Enable/disable guest rfp</td>
</tr>
<tr>
<td>oro_currency</td>
<td>default_currency</td>
<td>string</td>
<td>Sets the default platform currency</td>
</tr>
<tr>
<td>oro_multi_currency</td>
<td>allowed_currencies</td>
<td>string[]</td>
<td>Sets the allowed currencies</td>
</tr>
</tbody>
</table>
<blockquote>
<p>This list is obviously non exhaustive.</p>
<p>TIP: To find out the code of a setting we want to change, we can change it with the UI and then query the <code>oro_config_value</code> table: <code>select * from oro_config_value order by id desc</code>. The section code and the name of the setting are displayed in the result columns.</p>
</blockquote>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../delete-completely-an-enum/" class="btn btn-neutral float-right" title="Delete completely an enum">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../view/" class="btn btn-neutral" title="Managing the fields order on the form view"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../view/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../delete-completely-an-enum/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
